Роль mongodb_backup создает пользователя mongodb с ролью backup, добавляет крон-задание на снятие бэкапа бд раз в сутки и его загрузку в указанный s3 бакет AWS.
Перед раскаткой роли необходимо задавать переменные в group vars или в defaults/main.yaml для доступа к бакету, а также пароль alertmanager. 
Убедитесь, что на целевых хостах настроен AWS CLI с доступом к S3 (через ключи или используя профиль для инстанса ec2). Роль проверяет установку AWS

Роли задается retention_policy хранения бэкапов в бакете и локально. По умолчанию переменная равна 7, метод retention - full backup
```
retention_policy
```

```
mongodb_backup_username:
mongodb_backup_password: 

s3_bucket:
region:
s3_path:

alertmanager_user: 
alertmanager_password: 
alertmanager_url:
```

Alertmanager работает с кредами и без, задается в defaults:
```
alertmanager_basic_auth_enabled: true
```

Также добавляет проверку наличия бэкапов за последние 2 дня локально и в облачном хранилище.
Запускать роль необходимо на всю группу хостов mongodb, в host_vars задается необходимость настройки бэкапа для хоста с переменной:
```
mongodb_backup_enabled: true
```
В group_vars/mongodb.yml задается пароль бэкапного пользователя для подключения к mongodb, настройки подключения к alertmanager (url, user) и адрес s3 бакета в aws.
Если необходимо сменить настройки кронов или дефолтные настройки подключения к бд (mongodb_host, mongodb_port), то это задается в дефолтных переменных роли.

При отсутствии архивов или расхождении размеров архивов более, чем на 5%, отправляются алерты с соответствующим названием в alertmanager, которые будут существовать 2 дня с момента алерта или до момента их резолва при следующем снятии бэкапа.
При фейле бэкапа отправляется алерт с соответствующим названием в alertmanager, который будет существовать 2 дня с момента алерта или до следующего успешного снятия бэкапа.
